<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>broadcaster: src/main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">broadcaster<span id="projectnumber">&#160;0.0.0</span>
   </div>
   <div id="projectbrief">A command line utility for reading sensor data over I2C and providing it over stdout.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;../logging-utils/logging.h&quot;</code><br />
<code>#include &quot;<a class="el" href="radio_8h_source.html">radio.h</a>&quot;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;getopt.h&gt;</code><br />
<code>#include &lt;mqueue.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;termios.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae1af1583dad632433850cde64a74f7d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ae1af1583dad632433850cde64a74f7d8">TOP_PRIORITY</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ae1af1583dad632433850cde64a74f7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b20d41d6252e9871430c242cb1a56e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a6b20d41d6252e9871430c242cb1a56e7">BUFFER_SIZE</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:a6b20d41d6252e9871430c242cb1a56e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4eba3b0ea03f397bae8792d0f0e4cd4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ad4eba3b0ea03f397bae8792d0f0e4cd4">RETRY_LIMIT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ad4eba3b0ea03f397bae8792d0f0e4cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0411b67a2dba87758fee4f77c888558"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#af0411b67a2dba87758fee4f77c888558">IN_QUEUE</a>&#160;&#160;&#160;&quot;plogger-out&quot;</td></tr>
<tr class="separator:af0411b67a2dba87758fee4f77c888558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18fd22b406401357523a9d66220e6571"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a18fd22b406401357523a9d66220e6571">validate_param</a>(vfunc,  message)</td></tr>
<tr class="separator:a18fd22b406401357523a9d66220e6571"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af00b615ca097c43dbb02ae3a00ea3a62"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#af00b615ca097c43dbb02ae3a00ea3a62">buffer</a> [<a class="el" href="main_8c.html#a6b20d41d6252e9871430c242cb1a56e7">BUFFER_SIZE</a>]</td></tr>
<tr class="separator:af00b615ca097c43dbb02ae3a00ea3a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e200991063e6ea86174a4822b3421f8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a2e200991063e6ea86174a4822b3421f8">from_q</a> = true</td></tr>
<tr class="separator:a2e200991063e6ea86174a4822b3421f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27719cd8ae7f31f261a75535499776da"><td class="memItemLeft" align="right" valign="top">mqd_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a27719cd8ae7f31f261a75535499776da">input_q</a></td></tr>
<tr class="separator:a27719cd8ae7f31f261a75535499776da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa07302a9f1b3dd51f6d44ab2c34060a2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aa07302a9f1b3dd51f6d44ab2c34060a2">serial_port</a> = NULL</td></tr>
<tr class="separator:aa07302a9f1b3dd51f6d44ab2c34060a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a93d90b9a891dbeaed7ad99f2f7e1d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlora__params__t.html">lora_params_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a44a93d90b9a891dbeaed7ad99f2f7e1d">radio_parameters</a></td></tr>
<tr class="separator:a44a93d90b9a891dbeaed7ad99f2f7e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6b20d41d6252e9871430c242cb1a56e7" name="a6b20d41d6252e9871430c242cb1a56e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b20d41d6252e9871430c242cb1a56e7">&#9670;&#160;</a></span>BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUFFER_SIZE&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The read buffer size for incoming data. Since no radio packet can be greater than 512 bytes, and data is provided in ASCII encoding for hex symbols, one byte of data will be one ASCII hex character. So a 512 character buffer is sufficient for all packet sizes. </p>

</div>
</div>
<a id="af0411b67a2dba87758fee4f77c888558" name="af0411b67a2dba87758fee4f77c888558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0411b67a2dba87758fee4f77c888558">&#9670;&#160;</a></span>IN_QUEUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IN_QUEUE&#160;&#160;&#160;&quot;plogger-out&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The name of the message queue to read input from. </p>

</div>
</div>
<a id="ad4eba3b0ea03f397bae8792d0f0e4cd4" name="ad4eba3b0ea03f397bae8792d0f0e4cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4eba3b0ea03f397bae8792d0f0e4cd4">&#9670;&#160;</a></span>RETRY_LIMIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RETRY_LIMIT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >How many times broadcaster will attempt to transmit a packet before giving up. </p>

</div>
</div>
<a id="ae1af1583dad632433850cde64a74f7d8" name="ae1af1583dad632433850cde64a74f7d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1af1583dad632433850cde64a74f7d8">&#9670;&#160;</a></span>TOP_PRIORITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOP_PRIORITY&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The priority above which all messages will be guaranteed to be sent. </p>

</div>
</div>
<a id="a18fd22b406401357523a9d66220e6571" name="a18fd22b406401357523a9d66220e6571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18fd22b406401357523a9d66220e6571">&#9670;&#160;</a></span>validate_param</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define validate_param</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vfunc, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">message&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">if</span> (vfunc(optarg, &amp;<a class="code hl_variable" href="main_8c.html#a44a93d90b9a891dbeaed7ad99f2f7e1d">radio_parameters</a>)) {                                                                            \</div>
<div class="line">        fprintf(stderr, message, optarg);                                                                              \</div>
<div class="line">        exit(EXIT_FAILURE);                                                                                            \</div>
<div class="line">    }</div>
<div class="ttc" id="amain_8c_html_a44a93d90b9a891dbeaed7ad99f2f7e1d"><div class="ttname"><a href="main_8c.html#a44a93d90b9a891dbeaed7ad99f2f7e1d">radio_parameters</a></div><div class="ttdeci">struct lora_params_t radio_parameters</div><div class="ttdef"><b>Definition:</b> main.c:53</div></div>
</div><!-- fragment --><p >A macro for exiting with a failure when validation fails. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vfunc</td><td>The validation function, which should take optarg and radio_parameters as parameters. </td></tr>
    <tr><td class="paramname">message</td><td>The message to be printed when validation fails. Should include a s option for optarg. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af00b615ca097c43dbb02ae3a00ea3a62" name="af00b615ca097c43dbb02ae3a00ea3a62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af00b615ca097c43dbb02ae3a00ea3a62">&#9670;&#160;</a></span>buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char buffer[<a class="el" href="main_8c.html#a6b20d41d6252e9871430c242cb1a56e7">BUFFER_SIZE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The read buffer for input. </p>

</div>
</div>
<a id="a2e200991063e6ea86174a4822b3421f8" name="a2e200991063e6ea86174a4822b3421f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e200991063e6ea86174a4822b3421f8">&#9670;&#160;</a></span>from_q</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool from_q = true</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Whether to read from a message queue or from stdin. Queue by default. </p>

</div>
</div>
<a id="a27719cd8ae7f31f261a75535499776da" name="a27719cd8ae7f31f261a75535499776da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27719cd8ae7f31f261a75535499776da">&#9670;&#160;</a></span>input_q</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mqd_t input_q</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Input message queue file descriptor. </p>

</div>
</div>
<a id="a44a93d90b9a891dbeaed7ad99f2f7e1d" name="a44a93d90b9a891dbeaed7ad99f2f7e1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a93d90b9a891dbeaed7ad99f2f7e1d">&#9670;&#160;</a></span>radio_parameters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlora__params__t.html">lora_params_t</a> radio_parameters</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {.modulation = <a class="code hl_enumvalue" href="radio_8h.html#a22e5da42c3350892b86104c516865de2a082b1eaa6386e5c3c0204226b4824c07">LORA</a>,</div>
<div class="line">                                         .frequency = 433050000,</div>
<div class="line">                                         .power = 15,</div>
<div class="line">                                         .spread_factor = 7,</div>
<div class="line">                                         .coding_rate = <a class="code hl_enumvalue" href="radio_8h.html#a6e6bd8a7bb148453310b1d83c25a6c53afaec525569c1f205b98228986604a943">CR_4_7</a>,</div>
<div class="line">                                         .bandwidth = 500,</div>
<div class="line">                                         .preamble_len = 6,</div>
<div class="line">                                         .cyclic_redundancy = <span class="keyword">true</span>,</div>
<div class="line">                                         .iqi = <span class="keyword">false</span>,</div>
<div class="line">                                         .sync_word = 0x43}</div>
<div class="ttc" id="aradio_8h_html_a22e5da42c3350892b86104c516865de2a082b1eaa6386e5c3c0204226b4824c07"><div class="ttname"><a href="radio_8h.html#a22e5da42c3350892b86104c516865de2a082b1eaa6386e5c3c0204226b4824c07">LORA</a></div><div class="ttdeci">@ LORA</div><div class="ttdef"><b>Definition:</b> radio.h:18</div></div>
<div class="ttc" id="aradio_8h_html_a6e6bd8a7bb148453310b1d83c25a6c53afaec525569c1f205b98228986604a943"><div class="ttname"><a href="radio_8h.html#a6e6bd8a7bb148453310b1d83c25a6c53afaec525569c1f205b98228986604a943">CR_4_7</a></div><div class="ttdeci">@ CR_4_7</div><div class="ttdef"><b>Definition:</b> radio.h:26</div></div>
</div><!-- fragment --><p >The default radio parameters. </p>

</div>
</div>
<a id="aa07302a9f1b3dd51f6d44ab2c34060a2" name="aa07302a9f1b3dd51f6d44ab2c34060a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa07302a9f1b3dd51f6d44ab2c34060a2">&#9670;&#160;</a></span>serial_port</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* serial_port = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The device name of the serial port connected to the LoRa radio. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
